<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Countdown — LDC Study Planner</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --primary: #4f46e5;
    --primary-dark: #4338ca;
    --secondary: #9333ea;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --light-bg: #f8fafc;
    --dark-bg: #1f2937;
    --card-bg: #ffffff;
    --text-primary: #1f2937;
    --text-secondary: #6b7280;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background-color: var(--light-bg);
    color: var(--text-primary);
    transition: all 0.3s ease;
    overflow-x: hidden;
  }

  .dark-mode {
    --light-bg: #111827;
    --card-bg: #1f2937;
    --text-primary: #f9fafb;
    --text-secondary: #d1d5db;
  }

  .smooth-transition {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .card {
    background: var(--card-bg);
    border-radius: 12px;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
  }

  .card:hover {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    transform: translateY(-2px);
  }

  .btn-primary {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
  }

  .progress-bar {
    height: 8px;
    border-radius: 4px;
    background: #e5e7eb;
    overflow: hidden;
  }

  .progress-inner {
    height: 100%;
    background: linear-gradient(to right, var(--primary), var(--secondary));
    transition: width 0.5s ease;
  }

  .sidebar {
    width: 260px;
    background: var(--card-bg);
    height: 100vh;
    position: fixed;
    left: 0;
    top: 0;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
    z-index: 40;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    overflow-y: auto;
  }

  .sidebar.open {
    transform: translateX(0);
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 30;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .overlay.open {
    opacity: 1;
    visibility: visible;
  }

  .main-content {
    margin-left: 0;
    transition: margin-left 0.3s ease;
    min-height: 100vh;
  }

  @media (min-width: 1024px) {
    .sidebar {
      transform: translateX(0);
    }
    
    .main-content {
      margin-left: 260px;
    }
    
    .sidebar-toggle {
      display: none;
    }
  }

  .login-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 1rem;
  }

  .login-card {
    width: 100%;
    max-width: 400px;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .countdown-container {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
    color: white;
    flex-direction: column;
    text-align: center;
    padding: 1rem;
  }

  .countdown-title {
    font-size: 3rem;
    font-weight: 900;
    margin-bottom: 2rem;
    text-transform: uppercase;
    letter-spacing: 0.2em;
    background: linear-gradient(to right, #e53e3e, #ed8936, #ecc94b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  @media (min-width: 768px) {
    .countdown-title {
      font-size: 4rem;
    }
  }

  .scary-text {
    font-size: 1.2rem;
    margin-bottom: 1.5rem;
    max-width: 800px;
    line-height: 1.6;
    font-weight: 300;
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 1s ease forwards;
  }

  @media (min-width: 768px) {
    .scary-text {
      font-size: 1.5rem;
    }
  }

  .scary-text:nth-child(2) { animation-delay: 0.5s; }
  .scary-text:nth-child(3) { animation-delay: 1s; }
  .scary-text:nth-child(4) { animation-delay: 1.5s; }

  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .enter-button {
    margin-top: 2rem;
    padding: 1rem 2rem;
    font-size: 1.1rem;
    background: linear-gradient(to right, #e53e3e, #ed8936);
    border: none;
    border-radius: 8px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 1s ease 2s forwards;
    transition: all 0.3s ease;
  }

  .enter-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(229, 62, 62, 0.3);
  }

  .nav-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-radius: 8px;
    color: var(--text-secondary);
    transition: all 0.2s ease;
    margin-bottom: 4px;
    text-decoration: none;
  }

  .nav-item:hover {
    background: rgba(79, 70, 229, 0.1);
    color: var(--primary);
  }

  .nav-item.active {
    background: rgba(79, 70, 229, 0.15);
    color: var(--primary);
    font-weight: 600;
  }

  .subject-checkbox:checked + label {
    text-decoration: line-through;
    color: var(--text-secondary);
  }

  .session-item {
    border-left: 4px solid;
    padding: 12px 16px;
    margin-bottom: 8px;
    border-radius: 0 8px 8px 0;
    background: var(--card-bg);
    transition: all 0.2s ease;
  }

  .session-item:hover {
    transform: translateX(4px);
  }

  .fade-in {
    animation: fadeIn 0.5s ease forwards;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s ease-in-out infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .hidden {
    display: none !important;
  }

  .mobile-optimized {
    padding: 1rem;
  }

  .mobile-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1rem;
  }

  @media (min-width: 768px) {
    .mobile-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .mobile-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .mobile-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  @media (min-width: 768px) {
    .mobile-form {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }
  }

  .mobile-tabs {
    display: flex;
    overflow-x: auto;
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
    -webkit-overflow-scrolling: touch;
  }

  .mobile-tab {
    flex: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    margin-right: 0.5rem;
    background: var(--card-bg);
    color: var(--text-secondary);
    font-weight: 500;
    transition: all 0.2s ease;
  }

  .mobile-tab.active {
    background: var(--primary);
    color: white;
  }

  .touch-friendly {
    padding: 1rem;
    min-height: 44px;
    display: flex;
    align-items: center;
  }

  .mobile-header {
    padding: 1rem;
    position: sticky;
    top: 0;
    z-index: 20;
    background: var(--card-bg);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .countdown-display {
    font-size: 2rem;
    font-weight: bold;
    color: #ef4444;
    margin: 1rem 0;
  }

  @media (min-width: 768px) {
    .countdown-display {
      font-size: 3rem;
    }
  }

  .scare-text {
    font-style: italic;
    color: #6b7280;
    margin-bottom: 1rem;
  }

  .subject-card {
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .subject-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  }

  .completed {
    text-decoration: line-through;
    opacity: 0.7;
  }

  /* Enhanced Study Schedule Styles */
  .schedule-day {
    border-left: 4px solid;
    transition: all 0.3s ease;
  }

  .schedule-day:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
  }

  .time-badge {
    background: rgba(79, 70, 229, 0.1);
    color: var(--primary);
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
  }

  .schedule-session {
    border-left: 3px solid;
    padding: 8px 12px;
    margin: 4px 0;
    border-radius: 0 6px 6px 0;
    background: rgba(0, 0, 0, 0.03);
    transition: all 0.2s ease;
  }

  .schedule-session:hover {
    transform: translateX(4px);
  }

  .schedule-actions {
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .schedule-day:hover .schedule-actions {
    opacity: 1;
  }

  /* Print Styles */
  @media print {
    body * {
      visibility: hidden;
    }
    
    #planSection,
    #planSection * {
      visibility: visible;
    }
    
    #planSection {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      box-shadow: none;
      border: none;
    }
    
    .no-print {
      display: none !important;
    }
    
    .card {
      box-shadow: none;
      border: 1px solid #ddd;
    }
    
    .btn-primary, .schedule-actions {
      display: none !important;
    }
  }

  /* Time Input Styles */
  .time-inputs {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }

  .time-input {
    width: 80px;
    text-align: center;
  }

  .time-separator {
    font-weight: bold;
    color: var(--text-secondary);
  }
</style>
</head>
<body class="smooth-transition">

<!-- Login Screen -->
<div id="loginScreen" class="login-container">
  <div class="login-card">
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-indigo-700 mb-2"><i class="fas fa-book mr-2"></i>THE COUNTDOWN</h1>
      <p class="text-gray-600">Your Ultimate LDC 2025 Study Planner</p>
    </div>
    
    <div id="loginForm">
      <h2 class="text-xl font-semibold text-center mb-6">Welcome Back!</h2>
      
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="loginEmail">Email</label>
        <input id="loginEmail" type="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="your@email.com">
      </div>
      
      <div class="mb-6">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="loginPassword">Password</label>
        <input id="loginPassword" type="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="••••••••">
      </div>
      
      <button id="loginBtn" class="btn-primary w-full flex justify-center items-center touch-friendly">
        <span id="loginText">Sign In</span>
        <div id="loginSpinner" class="loading hidden ml-2"></div>
      </button>
      
      <div class="text-center mt-4">
        <button id="showRegister" class="text-indigo-600 hover:text-indigo-800 text-sm touch-friendly">
          Don't have an account? Sign up
        </button>
      </div>
    </div>
    
    <div id="registerForm" class="hidden">
      <h2 class="text-xl font-semibold text-center mb-6">Create Account</h2>
      
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="registerName">Full Name</label>
        <input id="registerName" type="text" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="John Doe">
      </div>
      
      <div class="mb-4">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="registerEmail">Email</label>
        <input id="registerEmail" type="email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="your@email.com">
      </div>
      
      <div class="mb-6">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="registerPassword">Password</label>
        <input id="registerPassword" type="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="••••••••">
      </div>
      
      <button id="registerBtn" class="btn-primary w-full flex justify-center items-center touch-friendly">
        <span id="registerText">Create Account</span>
        <div id="registerSpinner" class="loading hidden ml-2"></div>
      </button>
      
      <div class="text-center mt-4">
        <button id="showLogin" class="text-indigo-600 hover:text-indigo-800 text-sm touch-friendly">
          Already have an account? Sign in
        </button>
      </div>
    </div>
    
    <div class="mt-6 text-center text-xs text-gray-500">
      By continuing, you agree to our Terms of Service and Privacy Policy
    </div>
  </div>
</div>

<!-- Countdown Screen -->
<div id="countdownScreen" class="countdown-container hidden">
  <h1 class="countdown-title">COUNTDOWN</h1>
  <p class="scary-text">⏳ Time is slipping through your fingers...</p>
  <p class="scary-text">🔥 Every moment you waste brings failure closer</p>
  <p class="scary-text">😱 The exams are coming whether you're ready or not</p>
  <p class="scary-text">💀 Only the prepared will survive this challenge</p>
  <button id="enterAppBtn" class="enter-button touch-friendly">
    ENTER IF YOU DARE <i class="fas fa-arrow-right ml-2"></i>
  </button>
</div>

<!-- Main Application -->
<div id="appContainer" class="hidden">

  <!-- Sidebar Overlay -->
  <div id="sidebarOverlay" class="overlay"></div>

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <h1 class="text-xl font-bold text-indigo-600"><i class="fas fa-book mr-2"></i>COUNTDOWN</h1>
      <p class="text-sm text-gray-500 mt-1">LDC Study Planner</p>
    </div>
    
    <div class="p-4">
      <div class="mb-8">
        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Navigation</h2>
        <div class="space-y-1">
          <a href="#" class="nav-item active" data-section="dashboard">
            <i class="fas fa-tachometer-alt mr-3"></i>
            <span>Dashboard</span>
          </a>
          <a href="#" class="nav-item" data-section="study-plan">
            <i class="fas fa-calendar-alt mr-3"></i>
            <span>Study Plan</span>
          </a>
          <a href="#" class="nav-item" data-section="subjects">
            <i class="fas fa-book-open mr-3"></i>
            <span>Subjects</span>
          </a>
        </div>
      </div>
      
      <div>
        <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Account</h2>
        <div class="space-y-1">
          <a href="#" class="nav-item" id="logoutBtn">
            <i class="fas fa-sign-out-alt mr-3"></i>
            <span>Logout</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Header -->
    <header class="mobile-header bg-white dark:bg-gray-800 shadow-sm flex justify-between items-center">
      <div class="flex items-center">
        <button id="sidebarToggle" class="sidebar-toggle mr-4 text-gray-600 dark:text-gray-300 touch-friendly">
          <i class="fas fa-bars text-xl"></i>
        </button>
        <h2 id="pageTitle" class="text-xl font-semibold text-gray-800 dark:text-white">Dashboard</h2>
      </div>
      
      <div class="flex items-center space-x-4">
        <button id="toggleDark" class="p-3 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 touch-friendly">
          <i class="fas fa-moon"></i>
        </button>
        
        <div class="relative">
          <button id="userMenuBtn" class="flex items-center space-x-2 bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded-lg touch-friendly">
            <i class="fas fa-user-circle text-gray-600 dark:text-gray-300"></i>
            <span id="userName" class="font-medium text-gray-700 dark:text-white">User</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Dashboard Section -->
    <section id="dashboard" class="section active mobile-optimized">
      <!-- Countdown Section -->
      <div class="card p-6 mb-8 text-center">
        <h2 class="text-2xl font-semibold text-gray-800 dark:text-gray-200 mb-2">
          <i class="fas fa-clock mr-2"></i>Time Remaining
        </h2>
        <div id="countdown" class="countdown-display">53d 23h 39m 21s left</div>
        <p id="scareText" class="scare-text">💼 Only the prepared will pass!</p>
      </div>

      <!-- Overall Progress & Statistics -->
      <div class="mobile-grid mb-8">
        <!-- Overall Progress -->
        <div class="card p-6">
          <h2 class="text-xl font-semibold text-indigo-700 mb-4">
            <i class="fas fa-chart-line mr-2"></i>Overall Progress
          </h2>
          <div class="progress-bar mb-2">
            <div id="progressBar" class="progress-inner" style="width:0%;"></div>
          </div>
          <p id="progressText" class="text-sm text-gray-600 text-right">0/25 Subjects (0%) Completed</p>
        </div>

        <!-- Study Statistics -->
        <div class="card p-6">
          <h2 class="text-xl font-semibold text-indigo-700 mb-4">
            <i class="fas fa-chart-pie mr-2"></i>Study Statistics
          </h2>
          <div id="stats" class="grid grid-cols-2 gap-4 text-center">
            <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
              <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">0</div>
              <div class="text-sm text-blue-800 dark:text-blue-300">Completed</div>
            </div>
            <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
              <div class="text-2xl font-bold text-green-600 dark:text-green-400">25</div>
              <div class="text-sm text-green-800 dark:text-green-300">Remaining</div>
            </div>
            <div class="p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
              <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">0</div>
              <div class="text-sm text-purple-800 dark:text-purple-300">Sessions</div>
            </div>
            <div class="p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
              <div class="text-2xl font-bold text-orange-600 dark:text-orange-400">0%</div>
              <div class="text-sm text-orange-800 dark:text-orange-300">Progress</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Today's Focus -->
      <div class="card p-6 mb-8">
        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Today's Focus</h3>
        <div class="text-center py-4 text-gray-500">
          <i class="fas fa-calendar-plus text-4xl mb-3 opacity-50"></i>
          <p>No study sessions scheduled for today</p>
          <button class="btn-primary mt-4 touch-friendly" onclick="switchSection('study-plan')">
            Plan Your Study
          </button>
        </div>
      </div>
    </section>

    <!-- Study Plan Section -->
    <section id="study-plan" class="section hidden mobile-optimized">
      <div class="card p-6 mb-8">
        <h2 class="text-xl font-semibold text-indigo-700 mb-4">
          <i class="fas fa-calendar-plus mr-2"></i>Study Plan Generator
        </h2>
        
        <div class="mobile-form mb-6">
          <div>
            <label class="block text-gray-700 dark:text-gray-300 text-sm font-medium mb-2">Select Date</label>
            <input id="manualDate" type="date" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700" value="2025-10-14">
          </div>
          
          <div>
            <label class="block text-gray-700 dark:text-gray-300 text-sm font-medium mb-2">Study Time</label>
            <div class="time-inputs">
              <input id="startTime" type="time" class="time-input px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700" value="09:00">
              <span class="time-separator">to</span>
              <input id="endTime" type="time" class="time-input px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700" value="11:00">
            </div>
          </div>
        </div>
        
        <div class="mb-6">
          <label class="block text-gray-700 dark:text-gray-300 text-sm font-medium mb-2">Select Subjects</label>
          <select id="manualSubjects" multiple class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-gray-700 h-32">
            <!-- Subjects will be populated here -->
          </select>
        </div>
        
        <div class="flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
          <button id="addToPlan" class="btn-primary flex-1 touch-friendly">
            <i class="fas fa-plus mr-2"></i>Add to Plan
          </button>
          <button id="clearPlanBtn" class="px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors touch-friendly">
            <i class="fas fa-trash mr-2"></i>Clear Plan
          </button>
          <button id="printBtn" class="px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors touch-friendly no-print">
            <i class="fas fa-print mr-2"></i>Print Schedule
          </button>
        </div>
      </div>

      <!-- Generated Plan -->
      <div id="planSection" class="card p-6 mt-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-semibold text-indigo-700">
            <i class="fas fa-calendar-alt mr-2"></i>Your Study Schedule
          </h3>
          <div class="flex items-center space-x-4">
            <span id="planStats" class="text-sm text-gray-500">0 days, 0 sessions</span>
          </div>
        </div>
        
        <!-- Schedule View Options -->
        <div class="flex mb-4 no-print">
          <button id="viewDaily" class="mobile-tab active" data-view="daily">Daily View</button>
          <button id="viewWeekly" class="mobile-tab" data-view="weekly">Weekly View</button>
          <button id="viewMonthly" class="mobile-tab" data-view="monthly">Monthly View</button>
        </div>
        
        <!-- Schedule Display -->
        <div id="scheduleDisplay" class="space-y-4">
          <div class="text-center py-8 text-gray-500">
            <i class="fas fa-calendar-plus text-4xl mb-3 opacity-50"></i>
            <p>No study sessions scheduled yet</p>
            <p class="text-sm mt-2">Use the form above to create your study plan</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Subjects Section -->
    <section id="subjects" class="section hidden mobile-optimized">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Your Subjects</h2>
        <p class="text-gray-600 dark:text-gray-300">Track your progress across all LDC subjects</p>
      </div>

      <div class="mobile-grid">
        <!-- Civil Proceedings -->
        <div class="card p-5 subject-card">
          <h3 class="font-bold text-white text-lg mb-3 p-2 rounded-lg bg-gradient-to-r from-blue-500 to-cyan-500">
            Civil Proceedings
          </h3>
          <ul class="space-y-2">
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Pleadings</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Interlocutory Applications</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Trials</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Judgment & Appeals</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Execution of Decrees</label>
            </li>
          </ul>
        </div>

        <!-- Criminal Proceedings -->
        <div class="card p-5 subject-card">
          <h3 class="font-bold text-white text-lg mb-3 p-2 rounded-lg bg-gradient-to-r from-red-500 to-pink-500">
            Criminal Proceedings
          </h3>
          <ul class="space-y-2">
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Jurisdiction</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Charge & Information</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Bail & Remand</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Trial Process</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Sentencing & Appeals</label>
            </li>
          </ul>
        </div>

        <!-- Family Law Practice -->
        <div class="card p-5 subject-card">
          <h3 class="font-bold text-white text-lg mb-3 p-2 rounded-lg bg-gradient-to-r from-green-500 to-emerald-500">
            Family Law Practice
          </h3>
          <ul class="space-y-2">
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Marriage & Divorce</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Custody & Maintenance</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Adoption & Guardianship</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Matrimonial Property</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Domestic Violence</label>
            </li>
          </ul>
        </div>

        <!-- Corporate & Commercial Practice -->
        <div class="card p-5 subject-card">
          <h3 class="font-bold text-white text-lg mb-3 p-2 rounded-lg bg-gradient-to-r from-purple-500 to-indigo-500">
            Corporate & Commercial Practice
          </h3>
          <ul class="space-y-2">
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Company Formation</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Contracts</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Insolvency</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Mergers & Acquisitions</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Taxation</label>
            </li>
          </ul>
        </div>

        <!-- Land Practice -->
        <div class="card p-5 subject-card">
          <h3 class="font-bold text-white text-lg mb-3 p-2 rounded-lg bg-gradient-to-r from-amber-500 to-orange-500">
            Land Practice
          </h3>
          <ul class="space-y-2">
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Land Registration</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Conveyancing</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Mortgages</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Leases</label>
            </li>
            <li class="flex items-center space-x-2">
              <input type="checkbox" class="subject-checkbox w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500">
              <label class="text-gray-700 dark:text-gray-300">Dispute Resolution</label>
            </li>
          </ul>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
// Set dates dynamically
const currentYear = new Date().getFullYear();
const startTime = new Date(`${currentYear}-10-14T18:18:00`);
const deadline = new Date(`${currentYear}-12-07T23:59:59`);

const scareSayings = [
  "⏳ Time is slipping away!",
  "🔥 Every second counts!",
  "😱 Your exams are almost here!",
  "💼 Only the prepared will pass!",
  "⚖️ Justice favors the diligent!",
  "🚨 Wake up, Counsel! The clock is ticking!",
  "📖 Read now — rest later!",
  "🎯 Focus is your superpower!",
  "💪 Consistency beats intensity!",
  "🧠 Knowledge is your best weapon!"
];

const units = [
  { 
    title: "Civil Proceedings", 
    subjects: ["Pleadings", "Interlocutory Applications", "Trials", "Judgment & Appeals", "Execution of Decrees"],
    color: "from-blue-500 to-cyan-500",
    borderColor: "border-l-blue-500"
  },
  { 
    title: "Criminal Proceedings", 
    subjects: ["Jurisdiction", "Charge & Information", "Bail & Remand", "Trial Process", "Sentencing & Appeals"],
    color: "from-red-500 to-pink-500",
    borderColor: "border-l-red-500"
  },
  { 
    title: "Family Law Practice", 
    subjects: ["Marriage & Divorce", "Custody & Maintenance", "Adoption & Guardianship", "Matrimonial Property", "Domestic Violence"],
    color: "from-green-500 to-emerald-500",
    borderColor: "border-l-green-500"
  },
  { 
    title: "Corporate & Commercial Practice", 
    subjects: ["Company Formation", "Contracts", "Insolvency", "Mergers & Acquisitions", "Taxation"],
    color: "from-purple-500 to-indigo-500",
    borderColor: "border-l-purple-500"
  },
  { 
    title: "Land Practice", 
    subjects: ["Land Registration", "Conveyancing", "Mortgages", "Leases", "Dispute Resolution"],
    color: "from-amber-500 to-orange-500",
    borderColor: "border-l-amber-500"
  }
];

let studyPlan = [];
let currentUser = null;
let currentView = 'daily';

// User management functions
function getUsers() {
  const users = localStorage.getItem('ldcUsers');
  return users ? JSON.parse(users) : {};
}

function saveUsers(users) {
  localStorage.setItem('ldcUsers', JSON.stringify(users));
}

function getCurrentUserData() {
  if (!currentUser) return null;
  const users = getUsers();
  return users[currentUser] || null;
}

function saveCurrentUserData(userData) {
  if (!currentUser) return;
  const users = getUsers();
  users[currentUser] = userData;
  saveUsers(users);
}

// Initialize the app
function init() {
  // Check if user is already logged in
  const savedUser = localStorage.getItem('currentUser');
  if (savedUser) {
    currentUser = savedUser;
    showCountdownScreen();
  } else {
    showLoginScreen();
  }
  
  // Set up event listeners
  setupEventListeners();
}

// Show login screen
function showLoginScreen() {
  document.getElementById('loginScreen').classList.remove('hidden');
  document.getElementById('countdownScreen').classList.add('hidden');
  document.getElementById('appContainer').classList.add('hidden');
  
  // Clear any previous form data
  document.getElementById('loginEmail').value = '';
  document.getElementById('loginPassword').value = '';
  document.getElementById('registerName').value = '';
  document.getElementById('registerEmail').value = '';
  document.getElementById('registerPassword').value = '';
  
  // Show login form by default
  showLoginForm();
}

// Show countdown screen
function showCountdownScreen() {
  document.getElementById('loginScreen').classList.add('hidden');
  document.getElementById('countdownScreen').classList.remove('hidden');
  document.getElementById('appContainer').classList.add('hidden');
}

// Show app screen
function showAppScreen() {
  document.getElementById('loginScreen').classList.add('hidden');
  document.getElementById('countdownScreen').classList.add('hidden');
  document.getElementById('appContainer').classList.remove('hidden');
  
  // Load user data
  const userData = getCurrentUserData();
  if (userData) {
    document.getElementById('userName').textContent = userData.name;
    
    // Load user's study plan and progress
    studyPlan = userData.studyPlan || [];
    
    // Initialize app components
    initializeApp();
  }
}

// Setup event listeners
function setupEventListeners() {
  // Login/Register
  document.getElementById("loginBtn").addEventListener("click", handleLogin);
  document.getElementById("registerBtn").addEventListener("click", handleRegister);
  document.getElementById("showRegister").addEventListener("click", showRegisterForm);
  document.getElementById("showLogin").addEventListener("click", showLoginForm);
  document.getElementById("enterAppBtn").addEventListener("click", showAppScreen);
  document.getElementById("logoutBtn").addEventListener("click", handleLogout);
  
  // Sidebar
  document.getElementById("sidebarToggle").addEventListener("click", toggleSidebar);
  document.getElementById("sidebarOverlay").addEventListener("click", toggleSidebar);
  
  // Navigation
  document.querySelectorAll('.nav-item').forEach(item => {
    if (item.id !== 'logoutBtn') {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        switchSection(this.getAttribute('data-section'));
      });
    }
  });
  
  // Dark mode
  document.getElementById("toggleDark").addEventListener("click", toggleDarkMode);
  
  // Study plan
  document.getElementById("addToPlan").addEventListener("click", addToPlan);
  document.getElementById("clearPlanBtn").addEventListener("click", clearStudyPlan);
  document.getElementById("printBtn").addEventListener("click", printSchedule);
  
  // View options
  document.getElementById("viewDaily").addEventListener("click", () => switchView('daily'));
  document.getElementById("viewWeekly").addEventListener("click", () => switchView('weekly'));
  document.getElementById("viewMonthly").addEventListener("click", () => switchView('monthly'));
  
  // Subject checkboxes
  document.querySelectorAll('.subject-checkbox').forEach(checkbox => {
    checkbox.addEventListener('change', function() {
      updateProgress();
    });
  });
  
  // Allow Enter key to submit forms
  document.getElementById('loginEmail').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') handleLogin();
  });
  
  document.getElementById('loginPassword').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') handleLogin();
  });
  
  document.getElementById('registerName').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') handleRegister();
  });
  
  document.getElementById('registerEmail').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') handleRegister();
  });
  
  document.getElementById('registerPassword').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') handleRegister();
  });
}

// Show login form
function showLoginForm() {
  document.getElementById('loginForm').classList.remove('hidden');
  document.getElementById('registerForm').classList.add('hidden');
  removeAuthErrors();
}

// Show register form
function showRegisterForm() {
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('registerForm').classList.remove('hidden');
  removeAuthErrors();
}

// Handle user login
function handleLogin() {
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;
  
  if (!email || !password) {
    showAuthError('Please enter both email and password', 'loginForm');
    return;
  }
  
  // Show loading state
  document.getElementById('loginText').classList.add('hidden');
  document.getElementById('loginSpinner').classList.remove('hidden');
  
  // Simulate API call
  setTimeout(() => {
    const users = getUsers();
    
    if (users[email] && users[email].password === password) {
      // Successful login
      currentUser = email;
      localStorage.setItem('currentUser', email);
      showCountdownScreen();
    } else {
      showAuthError('Invalid email or password', 'loginForm');
    }
    
    // Hide loading state
    document.getElementById('loginText').classList.remove('hidden');
    document.getElementById('loginSpinner').classList.add('hidden');
  }, 1000);
}

// Handle user registration
function handleRegister() {
  const name = document.getElementById('registerName').value;
  const email = document.getElementById('registerEmail').value;
  const password = document.getElementById('registerPassword').value;
  
  if (!name || !email || !password) {
    showAuthError('Please fill in all fields', 'registerForm');
    return;
  }
  
  if (password.length < 6) {
    showAuthError('Password must be at least 6 characters long', 'registerForm');
    return;
  }
  
  // Show loading state
  document.getElementById('registerText').classList.add('hidden');
  document.getElementById('registerSpinner').classList.remove('hidden');
  
  // Simulate API call
  setTimeout(() => {
    const users = getUsers();
    
    if (users[email]) {
      showAuthError('An account with this email already exists', 'registerForm');
    } else {
      // Create new user
      users[email] = {
        name: name,
        password: password,
        studyPlan: [],
        progress: {},
        createdAt: new Date().toISOString()
      };
      
      saveUsers(users);
      
      // Auto-login after registration
      currentUser = email;
      localStorage.setItem('currentUser', email);
      showCountdownScreen();
    }
    
    // Hide loading state
    document.getElementById('registerText').classList.remove('hidden');
    document.getElementById('registerSpinner').classList.add('hidden');
  }, 1000);
}

// Handle user logout
function handleLogout() {
  currentUser = null;
  localStorage.removeItem('currentUser');
  showLoginScreen();
}

// Toggle sidebar
function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('sidebarOverlay').classList.toggle('open');
}

// Switch section
function switchSection(sectionId) {
  // Update active nav item
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
  
  // Update page title
  const titles = {
    'dashboard': 'Dashboard',
    'study-plan': 'Study Plan',
    'subjects': 'Subjects'
  };
  document.getElementById('pageTitle').textContent = titles[sectionId] || 'Dashboard';
  
  // Show section
  document.querySelectorAll('.section').forEach(section => {
    section.classList.add('hidden');
    section.classList.remove('active');
  });
  document.getElementById(sectionId).classList.remove('hidden');
  document.getElementById(sectionId).classList.add('active');
  
  // Close sidebar on mobile
  if (window.innerWidth < 1024) {
    toggleSidebar();
  }
}

// Switch view
function switchView(view) {
  currentView = view;
  
  // Update active view button
  document.querySelectorAll('.mobile-tab').forEach(tab => {
    tab.classList.remove('active');
  });
  document.querySelector(`[data-view="${view}"]`).classList.add('active');
  
  // Render schedule with new view
  renderStudyPlan();
}

// Toggle dark mode
function toggleDarkMode() {
  document.body.classList.toggle('dark-mode');
  const button = document.getElementById('toggleDark');
  
  if (document.body.classList.contains('dark-mode')) {
    button.innerHTML = '<i class="fas fa-sun"></i>';
    localStorage.setItem('darkMode', 'enabled');
  } else {
    button.innerHTML = '<i class="fas fa-moon"></i>';
    localStorage.setItem('darkMode', 'disabled');
  }
}

// Show authentication error
function showAuthError(message, formId) {
  removeAuthErrors();
  
  const errorEl = document.createElement('div');
  errorEl.className = 'auth-error bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4';
  errorEl.textContent = message;
  
  const currentForm = document.getElementById(formId);
  currentForm.insertBefore(errorEl, currentForm.firstChild);
  
  setTimeout(() => {
    if (errorEl.parentNode) {
      errorEl.remove();
    }
  }, 5000);
}

// Remove authentication errors
function removeAuthErrors() {
  const existingErrors = document.querySelectorAll('.auth-error');
  existingErrors.forEach(error => error.remove());
}

// Populate multi-select subjects dropdown
function populateSubjects() {
  const select = document.getElementById("manualSubjects");
  select.innerHTML = "";
  
  units.forEach(unit => {
    const group = document.createElement("optgroup");
    group.label = unit.title;
    
    unit.subjects.forEach(sub => {
      const option = document.createElement("option");
      option.value = sub;
      option.textContent = sub;
      group.appendChild(option);
    });
    
    select.appendChild(group);
  });
}

// Add manual plan
function addToPlan() {
  const date = document.getElementById("manualDate").value;
  const startTime = document.getElementById("startTime").value;
  const endTime = document.getElementById("endTime").value;
  const selected = Array.from(document.getElementById("manualSubjects").selectedOptions).map(o => o.value);
  
  if (!date || !startTime || !endTime || selected.length === 0) {
    showErrorAlert("Please select a date, time, and at least one subject!");
    return;
  }
  
  // Calculate duration in minutes
  const start = new Date(`2000-01-01T${startTime}`);
  const end = new Date(`2000-01-01T${endTime}`);
  const durationMinutes = (end - start) / (1000 * 60);
  
  if (durationMinutes <= 0) {
    showErrorAlert("End time must be after start time!");
    return;
  }
  
  studyPlan.push({ 
    date, 
    startTime, 
    endTime,
    duration: durationMinutes,
    sessions: selected 
  });
  
  // Save to user data
  const userData = getCurrentUserData();
  userData.studyPlan = studyPlan;
  saveCurrentUserData(userData);
  
  renderStudyPlan();
  updateStatistics();
  
  // Clear selection
  document.getElementById("manualSubjects").selectedIndex = -1;
}

// Show error alert
function showErrorAlert(message) {
  const alertDiv = document.createElement("div");
  alertDiv.className = "fixed top-4 right-4 bg-red-500 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm";
  alertDiv.innerHTML = `
    <div class="flex items-center">
      <i class="fas fa-exclamation-triangle mr-2 text-xl"></i>
      <div>
        <p class="font-semibold">Attention Needed</p>
        <p class="text-sm">${message}</p>
      </div>
    </div>
  `;
  
  document.body.appendChild(alertDiv);
  
  // Remove after 3 seconds
  setTimeout(() => {
    alertDiv.remove();
  }, 3000);
}

// Clear study plan
function clearStudyPlan() {
  if (studyPlan.length === 0) {
    showErrorAlert("Study plan is already empty!");
    return;
  }
  
  if (confirm("Are you sure you want to clear your entire study plan?")) {
    studyPlan = [];
    
    // Save to user data
    const userData = getCurrentUserData();
    userData.studyPlan = studyPlan;
    saveCurrentUserData(userData);
    
    renderStudyPlan();
    updateStatistics();
  }
}

// Print schedule
function printSchedule() {
  window.print();
}

// Update progress
function updateProgress() {
  const totalSubjects = 25; // 5 units × 5 subjects each
  const completedSubjects = document.querySelectorAll('.subject-checkbox:checked').length;
  const percent = Math.round((completedSubjects / totalSubjects) * 100);
  
  document.getElementById("progressBar").style.width = percent + "%";
  document.getElementById("progressText").textContent = `${completedSubjects}/${totalSubjects} Subjects (${percent}%) Completed`;
  
  // Update statistics
  document.getElementById('stats').innerHTML = `
    <div class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
      <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">${completedSubjects}</div>
      <div class="text-sm text-blue-800 dark:text-blue-300">Completed</div>
    </div>
    <div class="p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
      <div class="text-2xl font-bold text-green-600 dark:text-green-400">${totalSubjects - completedSubjects}</div>
      <div class="text-sm text-green-800 dark:text-green-300">Remaining</div>
    </div>
    <div class="p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
      <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">${studyPlan.reduce((sum, day) => sum + day.sessions.length, 0)}</div>
      <div class="text-sm text-purple-800 dark:text-purple-300">Sessions</div>
    </div>
    <div class="p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
      <div class="text-2xl font-bold text-orange-600 dark:text-orange-400">${percent}%</div>
      <div class="text-sm text-orange-800 dark:text-orange-300">Progress</div>
    </div>
  `;
}

// Update statistics
function updateStatistics() {
  updateProgress(); // Progress update will also update statistics
}

// Update countdown
function updateCountdown() {
  const now = new Date();
  const diff = deadline - now;
  
  if (diff <= 0) {
    document.getElementById('countdown').textContent = 'EXAMS HAVE BEGUN!';
    return;
  }
  
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
  const minutes = Math.floor((diff / (1000 * 60)) % 60);
  const seconds = Math.floor((diff / 1000) % 60);
  
  document.getElementById('countdown').textContent = `${days}d ${hours}h ${minutes}m ${seconds}s left`;
  
  // Update scare text randomly
  if (Math.random() < 0.01) { // 1% chance to change on each update
    document.getElementById('scareText').textContent = scareSayings[Math.floor(Math.random() * scareSayings.length)];
  }
}

// Render study plan
function renderStudyPlan() {
  const scheduleDisplay = document.getElementById("scheduleDisplay");
  const planStats = document.getElementById("planStats");
  
  scheduleDisplay.innerHTML = "";
  
  if (studyPlan.length === 0) {
    scheduleDisplay.innerHTML = `
      <div class="text-center py-8 text-gray-500">
        <i class="fas fa-calendar-plus text-4xl mb-3 opacity-50"></i>
        <p>No study sessions scheduled yet</p>
        <p class="text-sm mt-2">Use the form above to create your study plan</p>
      </div>
    `;
    planStats.textContent = "0 days, 0 sessions";
    return;
  }
  
  // Sort study plan by date
  studyPlan.sort((a, b) => new Date(a.date) - new Date(b.date));
  
  // Calculate plan stats
  const totalSessions = studyPlan.reduce((sum, day) => sum + day.sessions.length, 0);
  const totalHours = studyPlan.reduce((sum, day) => sum + (day.duration / 60), 0);
  planStats.textContent = `${studyPlan.length} days, ${totalSessions} sessions, ${Math.round(totalHours)} hours`;
  
  // Render based on current view
  if (currentView === 'daily') {
    renderDailyView(scheduleDisplay);
  } else if (currentView === 'weekly') {
    renderWeeklyView(scheduleDisplay);
  } else if (currentView === 'monthly') {
    renderMonthlyView(scheduleDisplay);
  }
}

// Render daily view
function renderDailyView(container) {
  studyPlan.forEach((day, index) => {
    const dayElement = document.createElement("div");
    dayElement.className = "schedule-day card p-4 border-l-4 border-indigo-500";
    
    // Day header
    const dayHeader = document.createElement("div");
    dayHeader.className = "flex justify-between items-center mb-3";
    
    const dateElement = document.createElement("div");
    dateElement.className = "font-semibold text-indigo-700";
    dateElement.innerHTML = `<i class="far fa-calendar mr-2"></i>${formatDate(day.date)}`;
    
    const timeElement = document.createElement("div");
    timeElement.className = "time-badge";
    timeElement.innerHTML = `<i class="far fa-clock mr-1"></i>${day.startTime} - ${day.endTime} (${Math.round(day.duration / 60)}h ${day.duration % 60}m)`;
    
    const actionsElement = document.createElement("div");
    actionsElement.className = "schedule-actions flex space-x-2";
    
    const deleteBtn = document.createElement("button");
    deleteBtn.className = "text-red-400 hover:text-red-600 transition-colors touch-friendly";
    deleteBtn.innerHTML = '<i class="fas fa-times"></i>';
    deleteBtn.onclick = () => {
      studyPlan.splice(index, 1);
      
      // Save to user data
      const userData = getCurrentUserData();
      userData.studyPlan = studyPlan;
      saveCurrentUserData(userData);
      
      renderStudyPlan();
      updateStatistics();
    };
    
    actionsElement.appendChild(deleteBtn);
    
    dayHeader.appendChild(dateElement);
    dayHeader.appendChild(timeElement);
    dayHeader.appendChild(actionsElement);
    
    // Sessions list
    const sessionsList = document.createElement("div");
    sessionsList.className = "space-y-2";
    
    day.sessions.forEach(session => {
      const sessionElement = document.createElement("div");
      sessionElement.className = "schedule-session border-l-indigo-300";
      
      const sessionContent = document.createElement("div");
      sessionContent.className = "flex justify-between items-center";
      
      const sessionTitle = document.createElement("div");
      sessionTitle.className = `font-medium text-gray-700`;
      sessionTitle.textContent = session;
      
      // Find which unit this session belongs to
      const unit = units.find(u => u.subjects.includes(session));
      const isCompleted = unit && document.querySelector(`input[type="checkbox"]:checked`) !== null;
      
      const sessionStatus = document.createElement("div");
      sessionStatus.className = "text-xs";
      
      if (isCompleted) {
        sessionStatus.innerHTML = '<i class="fas fa-check-circle text-green-500"></i>';
      } else {
        sessionStatus.innerHTML = '<i class="far fa-circle text-gray-400"></i>';
      }
      
      sessionContent.appendChild(sessionTitle);
      sessionContent.appendChild(sessionStatus);
      sessionElement.appendChild(sessionContent);
      
      sessionsList.appendChild(sessionElement);
    });
    
    dayElement.appendChild(dayHeader);
    dayElement.appendChild(sessionsList);
    container.appendChild(dayElement);
  });
}

// Render weekly view
function renderWeeklyView(container) {
  const weeks = groupStudyPlanByWeek(studyPlan);
  
  weeks.forEach((week, weekIndex) => {
    const weekElement = document.createElement("div");
    weekElement.className = "mb-6";
    
    // Week header
    const weekHeader = document.createElement("div");
    weekHeader.className = "flex justify-between items-center mb-4 p-3 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg";
    
    const weekTitle = document.createElement("h3");
    weekTitle.className = "font-bold text-indigo-700 text-lg";
    weekTitle.textContent = `Week ${weekIndex + 1} (${formatDate(week[0].date)} - ${formatDate(week[week.length-1].date)})`;
    
    const weekStats = document.createElement("div");
    weekStats.className = "text-sm text-indigo-600";
    const weekSessions = week.reduce((sum, day) => sum + day.sessions.length, 0);
    const weekHours = week.reduce((sum, day) => sum + (day.duration / 60), 0);
    weekStats.textContent = `${weekSessions} sessions, ${Math.round(weekHours)} hours`;
    
    weekHeader.appendChild(weekTitle);
    weekHeader.appendChild(weekStats);
    weekElement.appendChild(weekHeader);
    
    // Days grid
    const daysGrid = document.createElement("div");
    daysGrid.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4";
    
    week.forEach(day => {
      const dayElement = document.createElement("div");
      dayElement.className = "schedule-day card p-4 border-l-4 border-purple-500";
      
      // Day header
      const dayHeader = document.createElement("div");
      dayHeader.className = "flex justify-between items-center mb-2";
      
      const dateElement = document.createElement("div");
      dateElement.className = "font-semibold text-purple-700";
      dateElement.innerHTML = `<i class="far fa-calendar mr-2"></i>${formatDate(day.date, true)}`;
      
      const timeElement = document.createElement("div");
      timeElement.className = "time-badge bg-purple-100 text-purple-700";
      timeElement.innerHTML = `<i class="far fa-clock mr-1"></i>${day.startTime} - ${day.endTime}`;
      
      dayHeader.appendChild(dateElement);
      dayHeader.appendChild(timeElement);
      
      // Sessions list
      const sessionsList = document.createElement("div");
      sessionsList.className = "space-y-1 mt-2";
      
      day.sessions.forEach(session => {
        const sessionElement = document.createElement("div");
        sessionElement.className = "schedule-session border-l-purple-300 text-sm";
        sessionElement.textContent = session;
        sessionsList.appendChild(sessionElement);
      });
      
      dayElement.appendChild(dayHeader);
      dayElement.appendChild(sessionsList);
      daysGrid.appendChild(dayElement);
    });
    
    weekElement.appendChild(daysGrid);
    container.appendChild(weekElement);
  });
}

// Render monthly view
function renderMonthlyView(container) {
  const months = groupStudyPlanByMonth(studyPlan);
  
  months.forEach((month, monthIndex) => {
    const monthElement = document.createElement("div");
    monthElement.className = "mb-6";
    
    // Month header
    const monthHeader = document.createElement("div");
    monthHeader.className = "flex justify-between items-center mb-4 p-3 bg-gradient-to-r from-green-100 to-emerald-100 rounded-lg";
    
    const monthTitle = document.createElement("h3");
    monthTitle.className = "font-bold text-green-700 text-lg";
    monthTitle.textContent = `${formatMonth(month[0].date)}`;
    
    const monthStats = document.createElement("div");
    monthStats.className = "text-sm text-green-600";
    const monthSessions = month.reduce((sum, day) => sum + day.sessions.length, 0);
    const monthHours = month.reduce((sum, day) => sum + (day.duration / 60), 0);
    monthStats.textContent = `${monthSessions} sessions, ${Math.round(monthHours)} hours`;
    
    monthHeader.appendChild(monthTitle);
    monthHeader.appendChild(monthStats);
    monthElement.appendChild(monthHeader);
    
    // Days grid
    const daysGrid = document.createElement("div");
    daysGrid.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4";
    
    month.forEach(day => {
      const dayElement = document.createElement("div");
      dayElement.className = "schedule-day card p-3 border-l-4 border-green-500";
      
      // Day header
      const dateElement = document.createElement("div");
      dateElement.className = "font-semibold text-green-700 text-sm";
      dateElement.innerHTML = `<i class="far fa-calendar mr-1"></i>${formatDate(day.date, true)}`;
      
      // Time
      const timeElement = document.createElement("div");
      timeElement.className = "text-xs text-green-600 mt-1";
      timeElement.textContent = `${day.startTime} - ${day.endTime}`;
      
      // Sessions count
      const sessionsElement = document.createElement("div");
      sessionsElement.className = "text-xs text-gray-500 mt-1";
      sessionsElement.textContent = `${day.sessions.length} topics`;
      
      dayElement.appendChild(dateElement);
      dayElement.appendChild(timeElement);
      dayElement.appendChild(sessionsElement);
      daysGrid.appendChild(dayElement);
    });
    
    monthElement.appendChild(daysGrid);
    container.appendChild(monthElement);
  });
}

// Group study plan by week
function groupStudyPlanByWeek(studyPlan) {
  const weeks = [];
  let currentWeek = [];
  let currentWeekStart = null;
  
  studyPlan.forEach(day => {
    const date = new Date(day.date);
    const weekStart = getWeekStart(date);
    
    if (!currentWeekStart || weekStart.getTime() !== currentWeekStart.getTime()) {
      if (currentWeek.length > 0) {
        weeks.push(currentWeek);
      }
      currentWeek = [day];
      currentWeekStart = weekStart;
    } else {
      currentWeek.push(day);
    }
  });
  
  if (currentWeek.length > 0) {
    weeks.push(currentWeek);
  }
  
  return weeks;
}

// Group study plan by month
function groupStudyPlanByMonth(studyPlan) {
  const months = [];
  let currentMonth = [];
  let currentMonthStart = null;
  
  studyPlan.forEach(day => {
    const date = new Date(day.date);
    const monthStart = new Date(date.getFullYear(), date.getMonth(), 1);
    
    if (!currentMonthStart || monthStart.getTime() !== currentMonthStart.getTime()) {
      if (currentMonth.length > 0) {
        months.push(currentMonth);
      }
      currentMonth = [day];
      currentMonthStart = monthStart;
    } else {
      currentMonth.push(day);
    }
  });
  
  if (currentMonth.length > 0) {
    months.push(currentMonth);
  }
  
  return months;
}

// Get the start of the week (Monday)
function getWeekStart(date) {
  const day = date.getDay();
  const diff = date.getDate() - day + (day === 0 ? -6 : 1);
  return new Date(date.setDate(diff));
}

// Format date for display
function formatDate(dateString, short = false) {
  const options = short 
    ? { weekday: 'short', month: 'short', day: 'numeric' }
    : { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
  return new Date(dateString).toLocaleDateString('en-US', options);
}

// Format month for display
function formatMonth(dateString) {
  const options = { year: 'numeric', month: 'long' };
  return new Date(dateString).toLocaleDateString('en-US', options);
}

// Initialize app components
function initializeApp() {
  // Set default date to today
  document.getElementById("manualDate").valueAsDate = new Date();
  
  populateSubjects();
  updateProgress();
  updateCountdown();
  renderStudyPlan();
  updateStatistics();
  
  // Set up countdown interval
  setInterval(updateCountdown, 1000);
  
  // Check for saved dark mode preference
  if (localStorage.getItem('darkMode') === 'enabled') {
    document.body.classList.add('dark-mode');
    document.getElementById('toggleDark').innerHTML = '<i class="fas fa-sun"></i>';
  }
}

// Initialize the app when DOM is loaded
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
